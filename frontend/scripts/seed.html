<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Database Seeder</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 10px 10px 0;
        }
        .button:hover {
            background: #0056b3;
        }
        .button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #c3e6cb;
            margin: 15px 0;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #f5c6cb;
            margin: 15px 0;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #ffeaa7;
            margin: 15px 0;
        }
        #output {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            margin: 15px 0;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî• Firebase Database Seeder</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è Warning:</strong> This will create real data in your Firebase project. Make sure you're connected to your development/test environment.
        </div>

        <h3>What will be created:</h3>
        <ul>
            <li><strong>üë• 3 Users:</strong>
                <ul>
                    <li>Admin: admin@bookingsystem.com / admin123</li>
                    <li>Staff: sarah@bookingsystem.com / stylist123</li>
                    <li>Customer: customer@example.com / customer123</li>
                </ul>
            </li>
            <li><strong>‚úÇÔ∏è 5 Services:</strong> Haircuts, coloring, styling, treatments</li>
            <li><strong>üïí Business Hours:</strong> Standard schedules for staff</li>
        </ul>

        <div>
            <button id="seedAll" class="button">Seed Complete Database</button>
            <button id="seedUsers" class="button">Seed Users Only</button>
            <button id="checkFirebase" class="button">Test Firebase Connection</button>
        </div>

        <div id="output" class="hidden"></div>
        <div id="result"></div>
    </div>

    <!-- Import Firebase modules -->
    <script type="module">
        let isSeeding = false;
        
        function log(message) {
            const output = document.getElementById('output');
            output.classList.remove('hidden');
            output.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
            output.scrollTop = output.scrollHeight;
        }

        function showResult(message, isError = false) {
            const result = document.getElementById('result');
            result.className = isError ? 'error' : 'success';
            result.innerHTML = message;
        }

        function setButtonsDisabled(disabled) {
            document.querySelectorAll('.button').forEach(btn => {
                btn.disabled = disabled;
            });
            isSeeding = disabled;
        }

        // Test Firebase connection
        document.getElementById('checkFirebase').addEventListener('click', async () => {
            try {
                log('Testing Firebase connection...');
                
                // Try to import Firebase config
                const { auth, db } = await import('../firebase/config.js');
                
                if (auth && db) {
                    showResult('‚úÖ Firebase connection successful! You can proceed with seeding.');
                    log('Firebase Auth and Firestore initialized successfully');
                } else {
                    throw new Error('Firebase not properly initialized');
                }
            } catch (error) {
                log('‚ùå Firebase connection failed: ' + error.message);
                showResult('‚ùå Firebase connection failed. Please check your configuration.', true);
            }
        });

        // Seed users only
        document.getElementById('seedUsers').addEventListener('click', async () => {
            if (isSeeding) return;
            
            setButtonsDisabled(true);
            log('üå± Starting user seeding...');
            
            try {
                const { seedUsers } = await import('../firebase/seedData.js');
                const users = await seedUsers();
                
                log(`‚úÖ Successfully created ${users.length} users`);
                showResult(`‚úÖ Created ${users.length} users successfully!`);
                
                users.forEach(user => {
                    log(`  - ${user.email} (${user.role})`);
                });
                
            } catch (error) {
                log('‚ùå User seeding failed: ' + error.message);
                showResult('‚ùå User seeding failed: ' + error.message, true);
            } finally {
                setButtonsDisabled(false);
            }
        });

        // Seed complete database
        document.getElementById('seedAll').addEventListener('click', async () => {
            if (isSeeding) return;
            
            setButtonsDisabled(true);
            log('üå± Starting complete database seeding...');
            
            try {
                const { seedDatabase } = await import('../firebase/seedData.js');
                const result = await seedDatabase();
                
                if (result.success) {
                    log('‚úÖ Database seeding completed successfully!');
                    log(`üë• Users created: ${result.users?.length || 0}`);
                    log(`üõ†Ô∏è Services created: ${result.services?.length || 0}`);
                    
                    showResult(`‚úÖ Database seeded successfully!<br>Users: ${result.users?.length || 0}<br>Services: ${result.services?.length || 0}`);
                    
                    log('\nüéØ You can now login with:');
                    log('  Admin: admin@bookingsystem.com / admin123');
                    log('  Staff: sarah@bookingsystem.com / stylist123');
                    log('  Customer: customer@example.com / customer123');
                } else {
                    throw new Error(result.error);
                }
                
            } catch (error) {
                log('‚ùå Database seeding failed: ' + error.message);
                showResult('‚ùå Database seeding failed: ' + error.message, true);
            } finally {
                setButtonsDisabled(false);
            }
        });

        // Initial message
        log('Ready to seed Firebase database. Click "Test Firebase Connection" first.');
    </script>
</body>
</html>
